<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Building a Simple Molecular Force Field with Python | the curious neanderthaler</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Building a Simple Molecular Force Field with Python" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This jupyter-notebook contains some commented code showing how to build a simple molecular forcefield with Python." />
<meta property="og:description" content="This jupyter-notebook contains some commented code showing how to build a simple molecular forcefield with Python." />
<link rel="canonical" href="https://chloschen.github.io/fastpages/2020/02/28/forcefields_python.html" />
<meta property="og:url" content="https://chloschen.github.io/fastpages/2020/02/28/forcefields_python.html" />
<meta property="og:site_name" content="the curious neanderthaler" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-02-28T00:00:00-06:00" />
<script type="application/ld+json">
{"datePublished":"2020-02-28T00:00:00-06:00","url":"https://chloschen.github.io/fastpages/2020/02/28/forcefields_python.html","@type":"BlogPosting","headline":"Building a Simple Molecular Force Field with Python","dateModified":"2020-02-28T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://chloschen.github.io/fastpages/2020/02/28/forcefields_python.html"},"description":"This jupyter-notebook contains some commented code showing how to build a simple molecular forcefield with Python.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/fastpages/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://chloschen.github.io/fastpages/feed.xml" title="the curious neanderthaler" /><link rel="shortcut icon" type="image/x-icon" href="/fastpages/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/fastpages/">the curious neanderthaler</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/fastpages/about/">About Me</a><a class="page-link" href="/fastpages/search/">Search</a><a class="page-link" href="/fastpages/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Building a Simple Molecular Force Field with Python</h1><p class="page-description">This  jupyter-notebook contains some commented code showing  how to build a simple molecular forcefield with Python.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-02-28T00:00:00-06:00" itemprop="datePublished">
        Feb 28, 2020
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      8 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/CHLoschen/fastpages/tree/master/_notebooks/2020-02-28-forcefields_python.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/fastpages/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/CHLoschen/fastpages/master?filepath=_notebooks%2F2020-02-28-forcefields_python.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/fastpages/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/CHLoschen/fastpages/blob/master/_notebooks/2020-02-28-forcefields_python.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/fastpages/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Optimizing-Lennard-Jones-Cluster">Optimizing Lennard-Jones Cluster </a></li>
<li class="toc-entry toc-h2"><a href="#Coding">Coding </a></li>
<li class="toc-entry toc-h2"><a href="#Energies-and-Structure-Optimisation">Energies and Structure Optimisation </a></li>
<li class="toc-entry toc-h2"><a href="#Global-optimisation">Global optimisation </a>
<ul>
<li class="toc-entry toc-h3"><a href="#Visualization">Visualization </a></li>
<li class="toc-entry toc-h3"><a href="#Gradients">Gradients </a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#Outlook:-More-Complex-Force-Fields">Outlook: More Complex Force Fields </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-02-28-forcefields_python.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This  jupyter-notebook contains some commented code showing  how to build a simple molecular forcefield with Python using the libraries numpy and scipy. It is hosted on the <a href="https://colab.research.google.com/drive/1nxv8pMykWkkahoVp3kKmO7IBPPtziUsD">google colab platform</a> and only a web browser is needed to run it.</p>
<p>Force Field are used to determine molecular structures and their respective (relative) energies. They are used in very different settings, ranging from drug development to materials research.</p>
<p>Usually empirical potential energy functions are used that map  the atomic coordinates of a specifc configuration for a molecular, cluster or crystal $\textbf{X}$ to an scalar energy value $E$. $\textbf{X}$ just contains the (e.g. cartesian) coordinates of all the atoms in vector or matrix form. As the atomic positions are changed so changes the total energy.   <br></p>
<p>$E = f(\textbf{X})$</p>
<p>Variations of the atomic coordinates may then be carried out in order to find a (local) minimum of the energy, or more exact of the so-called potential energy surface (PES). If the gradient of the energy function is given, the efficiency of the optimization process can be significantly improved. Analytical gradients are functions that map the coordinates to a vector field giving the direction of the strongest rate of function value change at the point $\textbf{X}$.</p>
<p>Hence, energy and gradient evaluations are typical made for a given atomic configuration, the coordinates are updated with this information from the gradients, and a new configuration  $\textbf{X}'$ is obtained. This process is iterated until the energy or the gradient does not change anymore with respect to a given threshold.</p>
<p>To further characterize those states, 2nd order derivatives of the PES are also sometimes computed.</p>
<hr>
<h2 id="Optimizing-Lennard-Jones-Cluster">
<a class="anchor" href="#Optimizing-Lennard-Jones-Cluster" aria-hidden="true"><span class="octicon octicon-link"></span></a>Optimizing Lennard-Jones Cluster<a class="anchor-link" href="#Optimizing-Lennard-Jones-Cluster"> </a>
</h2>
<p>In order to construct our own little Force Field we deal with a very simple model system. Lennard-Jones clusters are atomic ensembles which are held together only by comparatively weak Van der Waals (VdW) Forces. No strong bonds are involved such as covalent bonds or hydrogen bonds, which typically define real molecules. However, the lack of directed bonds renders this system somewhat easier to treat. The VdW forces are experienced by all atoms and only depend on the interatomic distance:</p>
<p>$E = 4\epsilon\sum_{i&lt;j}\bigg[\bigg( \frac{\sigma}{r_{ij}}\bigg)^{12}-\bigg( \frac{\sigma}{r_{ij}}\bigg)^{6}\bigg]$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Coding">
<a class="anchor" href="#Coding" aria-hidden="true"><span class="octicon octicon-link"></span></a>Coding<a class="anchor-link" href="#Coding"> </a>
</h2>
<p>First we import the necessary libraries. In particular numpy (<a href="http://www.numpy.org/">http://www.numpy.org/</a>) for linear algebra and scipy (<a href="https://www.scipy.org/">https://www.scipy.org/</a>) for some  handy functions such as different optimizers. Its always a good idea not to re-invent the wheel...</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">basinhopping</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us define the computation of the energy in a separate function.  Here its useful to introduce the concept of the distance matrix, which is a $n_{atoms} \times n_{atoms}$ matrix containing all the possible distances between the atoms of the system. Effectively, we compute only the upper triangular part of the distance matrix, as only unique distances are needed.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">calc_energy</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span><span class="n">epsilon</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
  <span class="c1">#reshape coordinates to original 2D array</span>
  <span class="n">tmpv</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">natoms</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
  <span class="n">E</span><span class="o">=</span><span class="mf">0.0</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">natoms</span><span class="p">):</span>      
      <span class="n">distv</span> <span class="o">=</span> <span class="n">tmpv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">tmpv</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
      <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">distv</span><span class="p">)</span>
      <span class="n">E</span> <span class="o">+=</span> <span class="p">((</span><span class="n">sigma</span><span class="o">/</span><span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="mi">12</span><span class="o">-</span><span class="p">(</span><span class="n">sigma</span><span class="o">/</span><span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>        
  
  <span class="n">E</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">epsilon</span><span class="o">*</span><span class="n">E</span>
  <span class="k">return</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Defining the random seed for reproducibility. We want to get the same results for the same input in case we use a stochastic process.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us parameterize the size of the system, so we can change it later on. Be careful not to enter too large integers here, computations may become quite costly.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">natoms</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Generating some  random arrays via numpy, representing the initial atomic coordinates. Those will be far away from the minimum geometry, but we have to start somewhere. In this case we use  a $n_{atoms} \times 3$ matrix, containing in each row the x,y,z coordinates of an atom.<br>
For later use, we then  reshape the coordinates into a 1D vector, because the scipy minimize function expects this shape.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">natoms</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">natoms</span><span class="o">*</span><span class="mi">3</span><span class="p">,))</span>
<span class="n">coords</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0.03438852, 0.9093204 , 0.25877998, 0.66252228, 0.31171108,
       0.52006802, 0.54671028, 0.18485446, 0.96958463, 0.77513282,
       0.93949894, 0.89482735, 0.59789998, 0.92187424, 0.0884925 ])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Lets call and test the energy function, which we have defined earlier. It should give a rather large value, due to the randomness of the coordinates used as initial input.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Energies-and-Structure-Optimisation">
<a class="anchor" href="#Energies-and-Structure-Optimisation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Energies and Structure Optimisation<a class="anchor-link" href="#Energies-and-Structure-Optimisation"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">calc_energy</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>28134.0478850889</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now lets minimze the energy via the internal scipy minimize function. It containts a lot of different varations of minimizers, one is the Nealder-Mead simplex
method (by the way, not to be confused with the "simplex" method used in linear programming).<br>
The Nealder-Mead simplex does not need any gradients and hence is quite useful if no gradients are available. <br>For better performance we will have to implement gradients later on.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">calc_energy</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'Nelder-Mead'</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Energy: </span><span class="si">%16.6f</span><span class="s2"> after </span><span class="si">%d</span><span class="s2"> function evaluations using the simplex optimizer."</span><span class="o">%</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">fun</span><span class="p">,</span><span class="n">res</span><span class="o">.</span><span class="n">nfev</span><span class="p">))</span>
<span class="n">coords_opt</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">natoms</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Energy:        -9.103852 after 2323 function evaluations using the simplex optimizer.
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ok lets try another minimizer, the Broyden-Fletcher-Goldfarb-Shanno (BFGS) algorithm.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">calc_energy</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'BFGS'</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Energy: </span><span class="si">%16.6f</span><span class="s2"> after </span><span class="si">%d</span><span class="s2"> function evaluations using Broyden-Fletcher-Goldfarb-Shanno algorithm."</span><span class="o">%</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">fun</span><span class="p">,</span><span class="n">res</span><span class="o">.</span><span class="n">nfev</span><span class="p">))</span>
<span class="n">coords_opt</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">natoms</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Energy:        -9.103852 after 3802 function evaluations using Broyden-Fletcher-Goldfarb-Shanno algorithm.
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Global-optimisation">
<a class="anchor" href="#Global-optimisation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Global optimisation<a class="anchor-link" href="#Global-optimisation"> </a>
</h2>
<p>We just performed a local optimisation and hence it is possible that we missed the energetically lowest structure.</p>
<p>A global optimisation algorithm is ussually applied in order to to find the energetically lowest structure. Of course, we can never be 100% sure that we did not miss a lower energy structure with our search.</p>
<p>However, for this kind of small clusters however the possibilities are limited and we should have an energy of E=-6.0000 for 4 atom and E=-9.103 852 for 5 atoms. The difference between a normal optimisation and a global one will be much more significant for larger atom numbers. But be careful, computation will also like increase.</p>
<p>For pre-computed results on larger systems and on details of the basin-hopping algorithm have a look at:</p>
<p>D. J. Wales and J. P. K. Doye
The Journal of Physical Chemistry A <strong>1997</strong> 101 (28), 5111-5116.<br>
 (<a href="http://www-wales.ch.cam.ac.uk/pdf/JPCA.101.5111.1997.pdf">http://www-wales.ch.cam.ac.uk/pdf/JPCA.101.5111.1997.pdf</a>)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">basinhopping</span><span class="p">(</span><span class="n">calc_energy</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">coords_opt</span><span class="p">,</span><span class="n">niter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Energy: </span><span class="si">%16.6f</span><span class="s2"> after </span><span class="si">%d</span><span class="s2"> iterations."</span><span class="o">%</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">fun</span><span class="p">,</span><span class="n">res</span><span class="o">.</span><span class="n">nfev</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Energy:        -9.103852 after 234060 iterations.
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Visualization">
<a class="anchor" href="#Visualization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Visualization<a class="anchor-link" href="#Visualization"> </a>
</h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits</span> <span class="kn">import</span> <span class="n">mplot3d</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now some visualization to inspect the results.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">'3d'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">coords_opt</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords_opt</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">coords_opt</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'X'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Y'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">'Z'</span><span class="p">)</span>
<span class="n">limits</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">limits</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">limits</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="n">limits</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(-3.0, 3.0)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Gradients">
<a class="anchor" href="#Gradients" aria-hidden="true"><span class="octicon octicon-link"></span></a>Gradients<a class="anchor-link" href="#Gradients"> </a>
</h3>
<p>Now lets implement a gradient function here to improve optimization performance.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">calc_gradient</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span><span class="n">epsilon</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
  <span class="c1">#reshape coordinates to original 2D array</span>
  <span class="n">tmpv</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">natoms</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
  <span class="n">E</span><span class="o">=</span><span class="mf">0.0</span>
  <span class="n">grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">natoms</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">natoms</span><span class="p">):</span>      
      <span class="n">distv</span> <span class="o">=</span> <span class="n">tmpv</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">tmpv</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
      <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">distv</span><span class="p">)</span>
      <span class="n">E</span> <span class="o">+=</span> <span class="p">((</span><span class="n">sigma</span><span class="o">/</span><span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="mi">12</span><span class="o">-</span><span class="p">(</span><span class="n">sigma</span><span class="o">/</span><span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>
      <span class="n">grad_</span> <span class="o">=</span> <span class="o">-</span><span class="mi">12</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="n">sigma</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">13</span><span class="p">)</span> <span class="o">+</span> <span class="mi">6</span><span class="o">*</span> <span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="n">sigma</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
      <span class="n">grad</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">grad</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">grad_</span>
      <span class="n">grad</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">grad</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">grad_</span>           
  
  <span class="n">E</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">epsilon</span><span class="o">*</span><span class="n">E</span>
  <span class="n">grad</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">epsilon</span><span class="o">*</span><span class="n">grad</span>
  <span class="n">grad</span> <span class="o">=</span> <span class="n">grad</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">natoms</span><span class="o">*</span><span class="mi">3</span><span class="p">,))</span>
  <span class="k">return</span><span class="p">(</span><span class="n">grad</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For optimization we use the BFGS algorithm again, but this time with analytical gradient.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">calc_energy</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">coords_opt</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'BFGS'</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">calc_gradient</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Energy: </span><span class="si">%16.6f</span><span class="s2"> after </span><span class="si">%d</span><span class="s2"> function evaluations using gradient info."</span><span class="o">%</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">fun</span><span class="p">,</span><span class="n">res</span><span class="o">.</span><span class="n">nfev</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Energy:        -9.103852 after 98 function evaluations using gradient info.
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For a global optimzation we need a different strategy to ensure that we do not land in a local minimum. To use the scipy basin
hopin algorithm we to restructure the energy and the gradient function somewhat:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">calc_energy_with_gradient</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
  <span class="n">E</span> <span class="o">=</span> <span class="n">calc_energy</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span><span class="n">epsilon</span><span class="p">,</span><span class="n">sigma</span><span class="p">)</span>
  <span class="n">grad</span> <span class="o">=</span> <span class="n">calc_gradient</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span><span class="n">epsilon</span><span class="p">,</span><span class="n">sigma</span><span class="p">)</span>
  <span class="k">return</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">grad</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">minimizer_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"method"</span><span class="p">:</span><span class="s2">"L-BFGS-B"</span><span class="p">,</span> <span class="s2">"jac"</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">basinhopping</span><span class="p">(</span><span class="n">calc_energy_with_gradient</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">coords_opt</span><span class="p">,</span><span class="n">niter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">minimizer_kwargs</span><span class="o">=</span><span class="n">minimizer_kwargs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Energy: </span><span class="si">%16.6f</span><span class="s2"> after </span><span class="si">%d</span><span class="s2"> function evaluations."</span><span class="o">%</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">fun</span><span class="p">,</span><span class="n">res</span><span class="o">.</span><span class="n">nfev</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Energy:        -9.103852 after 5387 function evaluations.
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Outlook:-More-Complex-Force-Fields">
<a class="anchor" href="#Outlook:-More-Complex-Force-Fields" aria-hidden="true"><span class="octicon octicon-link"></span></a>Outlook: More Complex Force Fields<a class="anchor-link" href="#Outlook:-More-Complex-Force-Fields"> </a>
</h2>
<p>Usually, molecular Force Fields contain also directed interactions such as covalent or hydrogen bonds, in addition to VdW interactions.</p>
<p>They very much resemble a spring and beads model where the atoms in a molecule are held together by a spring.
The atomic connections i.e. covalent bonds between atoms have to be defined beforehand. Each bond is modelled in first order by a spring, which exerts
a force on the atoms which increases linear with the distance from the equilibrium bond length. Hence, each characteristic bond (C-C single bond, C=C double bond, O-H bond etc.) can be represented by a spring constant.</p>
<p>Due to the fact that all bonds are determined beforehand, no bonds can be made or be broken in typical Force Fields, in fact no real <em>chemistry</em> can take place, as opposed to quantum chemistry.</p>
<p>In addition to those covalent bond terms, angle terms, dihedral terms, Van der Waals terms and some special terms are sometimes added to the overall energy function.
The terms can be divided in bonded (e.g valence) terms $E_{val}$ and non-bonded terms $E_{nb}$ (see also J. Phys. Chem, Vol. 94, No. 26, 1990):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$E = E_{val}+E_{nb}$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The valence interaction typically consist out of bond stretch ($E_{B}$, two-body), bond-angle bend ($E_{A}$, three body) and dihedral angle torsion ($E_{T}$, four body), and inversion terms ($E_I$, four body).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$E_{val}=E_{B}+E_{A}+E_{T}+E_{I}$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The non-bonded interactions can may consist out of van der Waals or dispersion ($E_{vdW}$), electrostatic ($E_Q$) and explicit hydrogen bonding terms ($E_{hb}$):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$E_{nb}=E_{vdW}+E_{Q}+E_{hb}$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The global optimisation of this kind of energy function corresponds to a conformer search, where the global energy minimum represents  the most stable molecular conformation.</p>
<p>Molecular Force Field have their drawbacks such as their sometimes weak overall accuracy and lack of generality. But their are magnitudes faster than typical quantum chemical methods and are still in whitespread use.</p>
<p>The algorithms to optimize their structure are the same as for the more sophisticated quantum chemical methods.</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/fastpages/2020/02/28/forcefields_python.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/fastpages/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/fastpages/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/fastpages/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>This is a blog about stuff that interests me, on computational and natural sciences in general, machine &amp; deep learning, computational chemistry in particular.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" title="fastai"><svg class="svg-icon grey"><use xlink:href="/fastpages/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/fastpages/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
